---
- name: Install and configure tmux on Ubuntu
  hosts: all
  become: yes
  vars:
    tmux_config: |
      # Basic tmux configuration
      set -g default-terminal "screen-256color"
      set -g mouse on
      set -g base-index 1
      setw -g pane-base-index 1
      set -g renumber-windows on
      set -g history-limit 5000

      # Key bindings (Prefix: Ctrl-a)
      unbind C-b
      set -g prefix C-a
      bind C-a send-prefix

      # Split windows
      bind | split-window -h
      bind - split-window -v

      # Reload config
      bind r source-file ~/.tmux.conf \; display "Reloaded!"

  tasks:
    # Install tmux
    - name: Install tmux
      apt:
        name: tmux
        state: present
        update_cache: yes

    # Create tmux config directory
    - name: Ensure ~/.tmux directory exists
      ansible.builtin.file:
        path: ~/.tmux
        state: directory
        mode: '0755'

    # Deploy tmux configuration
    - name: Configure tmux
      ansible.builtin.copy:
        dest: ~/.tmux.conf
        content: "{{ tmux_config }}"
        mode: '0644'

